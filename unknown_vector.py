# https://stackoverflow.com/questions/49239941/what-is-unk-in-the-pretrained-glove-vector-files-e-g-glove-6b-50d-txt/53717345#53717345

# FILE TO GET AVERAGE OF ALL EMBEDDINGS IN GLOVE FILE

import numpy as np

GLOVE_FILE = '/Users/abhishekkuber/Desktop/SendAI Case Study/data/glove.6B.100d.txt'

# Get number of vectors and hidden dim
with open(GLOVE_FILE, 'r') as f:
    for i, line in enumerate(f):
        pass
n_vec = i + 1
hidden_dim = len(line.split(' ')) - 1

vecs = np.zeros((n_vec, hidden_dim), dtype=np.float32)

with open(GLOVE_FILE, 'r') as f:
    for i, line in enumerate(f):
        vecs[i] = np.array([float(n) for n in line.split(' ')[1:]], dtype=np.float32)

average_vec = np.mean(vecs, axis=0)

print(repr(average_vec))


'''

AVERAGE VEC

[ 0.05209883, -0.09711445, -0.1380765 ,  0.11075345, -0.02722748,
       -0.00326409,  0.03176443, -0.05076874,  0.15321693, -0.02367382,
       -0.0078552 ,  0.08436131, -0.08042031, -0.08836847, -0.01713637,
        0.07352565, -0.16472325,  0.05473585,  0.15367231, -0.05284015,
       -0.16474274, -0.00894895, -0.13604094, -0.03889371, -0.09204532,
        0.02874651,  0.02445944,  0.19419461, -0.03297978,  0.00509352,
        0.0146906 , -0.1554301 ,  0.03542742, -0.02936257,  0.01372886,
       -0.0606757 ,  0.02025392, -0.14560148,  0.05823914,  0.01729455,
        0.16282158,  0.18634756, -0.06337869,  0.1306742 , -0.11122588,
        0.0272168 ,  0.03868013,  0.15675613,  0.01344932,  0.1942456 ,
       -0.01218801,  0.03659216, -0.08235365, -0.24420363,  0.07523726,
        0.46423653,  0.06318451,  0.0508127 , -0.38147202, -0.20739552,
        0.03489431, -0.18234783,  0.09021272, -0.02504168, -0.22256528,
        0.03382994, -0.13379364, -0.14375682, -0.11264054, -0.03744001,
        0.06188852,  0.09650661,  0.08384212,  0.1964642 , -0.07446123,
        0.00921882,  0.03034359, -0.02482695,  0.27563572,  0.02422197,
       -0.23416583, -0.0523523 ,  0.10200828, -0.03673672,  0.2940292 ,
        0.05685116,  0.01759575,  0.07998175, -0.07554322,  0.14788596,
        0.01690632,  0.07576851,  0.07596124, -0.10800065,  0.20829839,
       -0.07841395,  0.08663727,  0.12381283, -0.23434106, -0.00925518]

'''